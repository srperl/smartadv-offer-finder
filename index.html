<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SmartADV Offer Finder</title>
</head>
<body>
  <h1>SmartADV Offer Finder</h1>
  <div id="offers">Loading offers...</div>

  <script>
    // TEMP: Replace these with your actual values
    const apiKey = 'patnPgIMAMI9ZXwum.7860eff03b9c59d78ad536532edb41bd347c6900e8f9724681452fd68757097a';
    const baseId = 'app12gesbScGlSR9r';
    const tableName = 'Imported table';

    fetch(`https://api.airtable.com/v0/${baseId}/${tableName}?maxRecords=15&filterByFormula={test subset}=1`, {
      headers: {
        Authorization: `Bearer ${apiKey}`,
      },
    })
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('offers');
        if (!data.records || data.records.length === 0) {
          container.innerHTML = "<p>No matching offers found.</p>";
          return;
        }
        container.innerHTML = data.records.map(record => {
          const f = record.fields;
          return `
            <div style="padding:10px; margin-bottom:15px; border:1px solid #ccc;">
              <h3>${f.Name || 'Unnamed Offer'}</h3>
              <p><strong>Category:</strong> ${f.Category?.join(', ') || 'N/A'}</p>
              <p><strong>Payout:</strong> $${f.Payout || 'N/A'}</p>
              <p><strong>GEOs:</strong> ${f.Countries?.join(', ') || 'N/A'}</p>
              <p><a href="${f['Portal Link']}" target="_blank">Apply Now</a></p>
            </div>
          `;
        }).join('');
      })
      .catch(err => {
        document.getElementById('offers').innerHTML = "⚠️ Error loading offers.";
        console.error(err);
      });
  </script>
</body>
</html>
